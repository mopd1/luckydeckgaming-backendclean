import{r as m,o as Z,a as S,b as l,c as T,d as D,e,w as t,f as i,t as I,g as ee,h as U,i as K,j as X,F as G,k as H,_ as re,l as de,n as ie,m as ue}from"./index-968909ce.js";const ce=U("span",null,"Available Tasks",-1),_e={__name:"TasksTab",setup(Q){const y=m([]),k=m(!0),s=m(!1),p=m(!1),u=m({task_id:"",name:"",description:"",action_id:"",required_repetitions:1,reward_type:"gems",reward_amount:100}),g=m([]),C=[{title:"Task ID",key:"task_id"},{title:"Name",key:"name"},{title:"Description",key:"description"},{title:"Required",key:"required_repetitions"},{title:"Reward",key:"reward_amount"},{title:"Actions",key:"actions",sortable:!1}];Z(async()=>{await Promise.all([x(),V()])});async function x(){try{k.value=!0;const _=await S.get("/daily-tasks/tasks");y.value=_.data.tasks}catch(_){console.error("Error loading tasks:",_)}finally{k.value=!1}}function $(_){p.value=!0,u.value={..._},s.value=!0}async function V(){try{const _=await S.get("/daily-tasks/actions");g.value=_.data.actions}catch(_){console.error("Error loading actions:",_)}}async function R(){try{const _={...u.value,required_repetitions:parseInt(u.value.required_repetitions),reward_amount:parseInt(u.value.reward_amount)};p.value?await S.put(`/daily-tasks/tasks/${_.task_id}`,_):await S.post("/daily-tasks/tasks",_),s.value=!1,await x()}catch(_){console.error("Error saving task:",_),alert("Failed to save task")}}return(_,v)=>{const A=l("v-btn"),O=l("v-card-title"),Y=l("v-icon"),z=l("v-data-table"),P=l("v-card"),q=l("v-text-field"),o=l("v-select"),c=l("v-form"),n=l("v-card-text"),a=l("v-spacer"),w=l("v-card-actions"),h=l("v-dialog");return T(),D("div",null,[e(P,null,{default:t(()=>[e(O,{class:"d-flex justify-space-between"},{default:t(()=>[ce,e(A,{color:"primary",onClick:v[0]||(v[0]=r=>s.value=!0)},{default:t(()=>[i("Add New Task")]),_:1})]),_:1}),e(z,{headers:C,items:y.value,loading:k.value,class:"elevation-1"},{"item.actions":t(({item:r})=>[e(A,{icon:"",size:"small",onClick:M=>$(r)},{default:t(()=>[e(Y,null,{default:t(()=>[i("mdi-pencil")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items","loading"])]),_:1}),e(h,{modelValue:s.value,"onUpdate:modelValue":v[9]||(v[9]=r=>s.value=r),"max-width":"600px"},{default:t(()=>[e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[i(I(p.value?"Edit Task":"Add New Task"),1)]),_:1}),e(n,null,{default:t(()=>[e(c,{onSubmit:ee(R,["prevent"])},{default:t(()=>[e(q,{modelValue:u.value.task_id,"onUpdate:modelValue":v[1]||(v[1]=r=>u.value.task_id=r),label:"Task ID",disabled:p.value,required:""},null,8,["modelValue","disabled"]),e(q,{modelValue:u.value.name,"onUpdate:modelValue":v[2]||(v[2]=r=>u.value.name=r),label:"Task Name",required:""},null,8,["modelValue"]),e(q,{modelValue:u.value.description,"onUpdate:modelValue":v[3]||(v[3]=r=>u.value.description=r),label:"Description",required:""},null,8,["modelValue"]),e(o,{modelValue:u.value.action_id,"onUpdate:modelValue":v[4]||(v[4]=r=>u.value.action_id=r),items:g.value,"item-title":"name","item-value":"action_id",label:"Action Type",required:"",hint:"Select the action that will trigger task progress","persistent-hint":""},null,8,["modelValue","items"]),e(q,{modelValue:u.value.required_repetitions,"onUpdate:modelValue":v[5]||(v[5]=r=>u.value.required_repetitions=r),label:"Required Repetitions",type:"number",min:"1",required:""},null,8,["modelValue"]),e(o,{modelValue:u.value.reward_type,"onUpdate:modelValue":v[6]||(v[6]=r=>u.value.reward_type=r),items:["gems","chips","action_points"],label:"Reward Type",required:""},null,8,["modelValue"]),e(q,{modelValue:u.value.reward_amount,"onUpdate:modelValue":v[7]||(v[7]=r=>u.value.reward_amount=r),label:"Reward Amount",type:"number",min:"0",required:""},null,8,["modelValue"])]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(a),e(A,{text:"",onClick:v[8]||(v[8]=r=>s.value=!1)},{default:t(()=>[i("Cancel")]),_:1}),e(A,{color:"primary",onClick:R},{default:t(()=>[i("Save")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},ve=U("span",null,"Task Sets",-1),me={key:1},pe={class:"d-flex align-center mb-4"},fe={__name:"SetsTab",setup(Q){const y=m([]),k=m([]),s=m([]),p=m(null),u=m(!0),g=m(!1),C=m(!1),x=m(!1),$=m(null),V=m({set_id:"",name:"",description:"",is_active:!0}),R=[{title:"Set ID",key:"set_id"},{title:"Name",key:"name"},{title:"Description",key:"description"},{title:"Tasks",key:"taskCount"},{title:"Actions",key:"actions",sortable:!1}],_=K(()=>{if(!s.value)return[];const n=s.value.map(a=>a.task_id);return k.value.filter(a=>!n.includes(a.task_id))}),v=K(()=>[...s.value].sort((n,a)=>n.display_order-a.display_order));Z(async()=>{await Promise.all([A(),O()])});async function A(){try{u.value=!0;const n=await S.get("/daily-tasks/sets");y.value=n.data.sets.map(a=>{var w;return{...a,taskCount:((w=a.DailyTasks)==null?void 0:w.length)||0}})}catch(n){console.error("Error loading task sets:",n)}finally{u.value=!1}}async function O(){try{const n=await S.get("/daily-tasks/tasks");k.value=n.data.tasks}catch(n){console.error("Error loading tasks:",n)}}function Y(n){x.value=!0,V.value={...n},g.value=!0}async function z(){try{x.value?await S.put(`/daily-tasks/sets/${V.value.set_id}`,V.value):await S.post("/daily-tasks/sets",V.value),g.value=!1,await A()}catch(n){console.error("Error saving task set:",n),alert("Failed to save task set")}}async function P(n){p.value=n;try{const a=await S.get(`/daily-tasks/sets/${n.set_id}/tasks`);s.value=a.data.tasks,C.value=!0}catch(a){console.error("Error loading set tasks:",a)}}async function q(){if(!(!$.value||!p.value))try{const n=k.value.find(h=>h.task_id===$.value);if(!n)return;const a=s.value.length>0?Math.max(...s.value.map(h=>parseInt(h.display_order)))+1:0,w=await S.post(`/daily-tasks/sets/${p.value.set_id}/tasks`,{task_id:$.value,display_order:a});s.value.push({...n,display_order:a}),$.value=null}catch(n){console.error("Error adding task to set:",n),alert("Failed to add task to set")}}async function o(n){try{await S.put(`/daily-tasks/sets/${p.value.set_id}/tasks/${n.task_id}`,{display_order:parseInt(n.display_order)})}catch(a){console.error("Error updating task order:",a),alert("Failed to update task order")}}async function c(n){try{await S.delete(`/daily-tasks/sets/${p.value.set_id}/tasks/${n.task_id}`),s.value=s.value.filter(a=>a.task_id!==n.task_id)}catch(a){console.error("Error removing task from set:",a),alert("Failed to remove task")}}return(n,a)=>{const w=l("v-btn"),h=l("v-card-title"),r=l("v-icon"),M=l("v-data-table"),E=l("v-card"),N=l("v-text-field"),j=l("v-textarea"),J=l("v-switch"),f=l("v-form"),B=l("v-card-text"),b=l("v-spacer"),F=l("v-card-actions"),L=l("v-dialog"),te=l("v-alert"),ae=l("v-select"),le=l("v-list-subheader"),ne=l("v-list-item-title"),se=l("v-list-item"),oe=l("v-list");return T(),D("div",null,[e(E,null,{default:t(()=>[e(h,{class:"d-flex justify-space-between"},{default:t(()=>[ve,e(w,{color:"primary",onClick:a[0]||(a[0]=d=>g.value=!0)},{default:t(()=>[i("Add New Set")]),_:1})]),_:1}),e(M,{headers:R,items:y.value,loading:u.value,class:"elevation-1"},{"item.actions":t(({item:d})=>[e(w,{icon:"",size:"small",onClick:W=>Y(d)},{default:t(()=>[e(r,null,{default:t(()=>[i("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(w,{icon:"",size:"small",onClick:W=>P(d),class:"ml-2"},{default:t(()=>[e(r,null,{default:t(()=>[i("mdi-format-list-checks")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items","loading"])]),_:1}),e(L,{modelValue:g.value,"onUpdate:modelValue":a[6]||(a[6]=d=>g.value=d),"max-width":"600px"},{default:t(()=>[e(E,null,{default:t(()=>[e(h,null,{default:t(()=>[i(I(x.value?"Edit Task Set":"Add New Task Set"),1)]),_:1}),e(B,null,{default:t(()=>[e(f,{onSubmit:ee(z,["prevent"])},{default:t(()=>[e(N,{modelValue:V.value.set_id,"onUpdate:modelValue":a[1]||(a[1]=d=>V.value.set_id=d),label:"Set ID",disabled:x.value,required:"",hint:"Use a unique identifier (e.g., weekend-tasks, monday-special)"},null,8,["modelValue","disabled"]),e(N,{modelValue:V.value.name,"onUpdate:modelValue":a[2]||(a[2]=d=>V.value.name=d),label:"Set Name",required:""},null,8,["modelValue"]),e(j,{modelValue:V.value.description,"onUpdate:modelValue":a[3]||(a[3]=d=>V.value.description=d),label:"Description"},null,8,["modelValue"]),e(J,{modelValue:V.value.is_active,"onUpdate:modelValue":a[4]||(a[4]=d=>V.value.is_active=d),label:"Active"},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:t(()=>[e(b),e(w,{text:"",onClick:a[5]||(a[5]=d=>g.value=!1)},{default:t(()=>[i("Cancel")]),_:1}),e(w,{color:"primary",onClick:z},{default:t(()=>[i("Save")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(L,{modelValue:C.value,"onUpdate:modelValue":a[9]||(a[9]=d=>C.value=d),"max-width":"800px"},{default:t(()=>[e(E,null,{default:t(()=>[e(h,null,{default:t(()=>{var d;return[i("Manage Tasks for "+I((d=p.value)==null?void 0:d.name),1)]}),_:1}),e(B,null,{default:t(()=>[_.value.length===0&&s.value.length===0?(T(),X(te,{key:0,type:"info"},{default:t(()=>[i(" No tasks available. Please create tasks first. ")]),_:1})):(T(),D("div",me,[U("div",pe,[e(ae,{modelValue:$.value,"onUpdate:modelValue":a[7]||(a[7]=d=>$.value=d),items:_.value,"item-title":"name","item-value":"task_id",label:"Add Task",class:"mr-2",disabled:_.value.length===0},null,8,["modelValue","items","disabled"]),e(w,{color:"primary",onClick:q,disabled:!$.value},{default:t(()=>[i(" Add ")]),_:1},8,["disabled"])]),e(oe,null,{default:t(()=>[e(le,null,{default:t(()=>[i("Tasks in this set")]),_:1}),(T(!0),D(G,null,H(v.value,d=>(T(),X(se,{key:d.task_id},{prepend:t(()=>[e(r,null,{default:t(()=>[i("mdi-drag-vertical")]),_:1})]),append:t(()=>[e(N,{modelValue:d.display_order,"onUpdate:modelValue":W=>d.display_order=W,type:"number",density:"compact",style:{width:"80px"},class:"mr-2",onChange:W=>o(d)},null,8,["modelValue","onUpdate:modelValue","onChange"]),e(w,{icon:"",size:"small",onClick:W=>c(d)},{default:t(()=>[e(r,null,{default:t(()=>[i("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),default:t(()=>[e(ne,null,{default:t(()=>[i(I(d.name),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),e(F,null,{default:t(()=>[e(b),e(w,{text:"",onClick:a[8]||(a[8]=d=>C.value=!1)},{default:t(()=>[i("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};const ke={class:"d-flex justify-space-between align-center w-100"},ye={class:"calendar"},ge=["onClick"],we={class:"day-number"},be={key:0,class:"task-set-indicator"},Ve={__name:"CalendarTab",setup(Q){const y=m(new Date().getFullYear()),k=m(new Date().getMonth()),s=m([]),p=m(null),u=m([]),g=m({}),C=m(!1),x=["January","February","March","April","May","June","July","August","September","October","November","December"],$=K(()=>x[k.value]),V=K(()=>{const o=y.value,c=k.value,n=new Date(o,c,1),a=new Date(o,c+1,0),h=n.getDay(),r=42,M=[],E=c===0?11:c-1,N=c===0?o-1:o,j=new Date(N,E+1,0).getDate();for(let b=0;b<h;b++){const F=j-h+b+1,L=`${N}-${String(E+1).padStart(2,"0")}-${String(F).padStart(2,"0")}`;M.push({day:F,date:L,currentMonth:!1})}for(let b=1;b<=a.getDate();b++){const F=`${o}-${String(c+1).padStart(2,"0")}-${String(b).padStart(2,"0")}`;M.push({day:b,date:F,currentMonth:!0})}const J=r-M.length,f=c===11?0:c+1,B=c===11?o+1:o;for(let b=1;b<=J;b++){const F=`${B}-${String(f+1).padStart(2,"0")}-${String(b).padStart(2,"0")}`;M.push({day:b,date:F,currentMonth:!1})}return M});Z(async()=>{await Promise.all([R(),_()])}),de([y,k],async()=>{await _()});async function R(){try{const o=await S.get("/daily-tasks/sets");u.value=o.data.sets}catch(o){console.error("Error loading task sets:",o)}}async function _(){try{C.value=!0;const o=y.value,c=k.value+1,n=await S.get(`/daily-tasks/calendar/${o}/${c}`);g.value=n.data.calendar}catch(o){console.error("Error loading calendar data:",o)}finally{C.value=!1}}function v(o){return s.value.includes(o)}function A(o){const c=s.value.indexOf(o);c===-1?s.value.push(o):s.value.splice(c,1)}function O(o){return g.value[o]!==void 0}function Y(o){var c;return((c=g.value[o])==null?void 0:c.set_name)||""}function z(){k.value===0?(k.value=11,y.value--):k.value--}function P(){k.value===11?(k.value=0,y.value++):k.value++}async function q(){if(!(!p.value||s.value.length===0))try{await S.post("/daily-tasks/calendar/set-dates",{setId:p.value,dates:s.value}),await _(),s.value=[]}catch(o){console.error("Error assigning task set to dates:",o),alert("Failed to update calendar")}}return(o,c)=>{const n=l("v-card-title"),a=l("v-radio"),w=l("v-radio-group"),h=l("v-card-text"),r=l("v-btn"),M=l("v-card-actions"),E=l("v-card"),N=l("v-col"),j=l("v-icon"),J=l("v-row");return T(),D("div",null,[e(J,null,{default:t(()=>[e(N,{cols:"12",md:"3"},{default:t(()=>[e(E,null,{default:t(()=>[e(n,null,{default:t(()=>[i("Task Sets")]),_:1}),e(h,null,{default:t(()=>[e(w,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=f=>p.value=f)},{default:t(()=>[(T(!0),D(G,null,H(u.value,f=>(T(),X(a,{key:f.set_id,label:f.name,value:f.set_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(M,null,{default:t(()=>[e(r,{block:"",color:"primary",onClick:q,disabled:!p.value||s.value.length===0},{default:t(()=>[i(" Apply to Selected Dates ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),e(N,{cols:"12",md:"9"},{default:t(()=>[e(E,null,{default:t(()=>[e(n,null,{default:t(()=>[U("div",ke,[U("div",null,[e(r,{icon:"",onClick:z},{default:t(()=>[e(j,null,{default:t(()=>[i("mdi-chevron-left")]),_:1})]),_:1}),i(" "+I($.value)+" "+I(y.value)+" ",1),e(r,{icon:"",onClick:P},{default:t(()=>[e(j,null,{default:t(()=>[i("mdi-chevron-right")]),_:1})]),_:1})]),U("div",null,[e(r,{text:"",onClick:c[1]||(c[1]=f=>s.value=[])},{default:t(()=>[i("Clear Selection")]),_:1})])])]),_:1}),e(h,null,{default:t(()=>[U("div",ye,[(T(),D(G,null,H(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=>U("div",{key:f,class:"calendar-header"},I(f),1)),64)),(T(!0),D(G,null,H(V.value,(f,B)=>(T(),D("div",{key:B,class:ie(["calendar-day",{"current-month":f.currentMonth,selected:v(f.date),"has-tasks":O(f.date)}]),onClick:b=>A(f.date)},[U("div",we,I(f.day),1),O(f.date)?(T(),D("div",be,I(Y(f.date)),1)):ue("",!0)],10,ge))),128))])]),_:1})]),_:1})]),_:1})]),_:1})])}}},he=re(Ve,[["__scopeId","data-v-fc09c3e1"]]),Se=U("h1",{class:"text-h4 mb-6"},"Daily Tasks Management",-1),xe={__name:"Index",setup(Q){const y=m("tasks");return(k,s)=>{const p=l("v-tab"),u=l("v-tabs"),g=l("v-window-item"),C=l("v-window");return T(),D("div",null,[Se,e(u,{modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=x=>y.value=x),"bg-color":"primary"},{default:t(()=>[e(p,{value:"tasks"},{default:t(()=>[i("Tasks")]),_:1}),e(p,{value:"sets"},{default:t(()=>[i("Task Sets")]),_:1}),e(p,{value:"calendar"},{default:t(()=>[i("Calendar")]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=x=>y.value=x),class:"mt-4"},{default:t(()=>[e(g,{value:"tasks"},{default:t(()=>[e(_e)]),_:1}),e(g,{value:"sets"},{default:t(()=>[e(fe)]),_:1}),e(g,{value:"calendar"},{default:t(()=>[e(he)]),_:1})]),_:1},8,["modelValue"])])}}};export{xe as default};
